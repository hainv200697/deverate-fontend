<ng-template #customLoadingTemplate>
    <div class="custom-class">

    </div>
</ng-template>
<ng-template #searchNull>
    <tr class="col-md-12 row no-padding-no-margin">
        <th class="text-center col-md-12" scope="col">No data</th>
    </tr>
</ng-template>
<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px',fullScreenBackdrop: true  }"
    [template]="customLoadingTemplate">
</ngx-loading>
<div class=" row col-md-12">
    <div class="row col-md-12">
        <div class="col-md-3">
            <b>
                <h2 class="page-header ">
                    Applicant Statistic
                </h2>
            </b>
        </div>
        <div class="col-md-3">
            <form class="form-inline">
                <div class="form-group row">
                    <label col-md-3>From</label>
                    <div class="input-group col-md-9">
                        <input class="form-control" (dateSelect)="changeInput()" placeholder="yyyy-mm-dd"
                         name="start" [(ngModel)]="startDate" [minDate]="startDate" [maxDate]="current"
                            ngbDatepicker #start="ngbDatepicker">
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary fa fa-calendar" (click)="start.toggle()"
                                type="button"></button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-md-3">
            <form class="form-inline">
                <div class="form-group row">
                    <label col-md-3>To</label>
                    <div class="input-group col-md-9">
                        <input class="form-control" (dateSelect)="changeInput()" placeholder="yyyy-mm-dd" 
                        name="end" [(ngModel)]="endDate" [minDate]="startDate" [maxDate]="current"
                            ngbDatepicker #end="ngbDatepicker">
                        <div class="input-group-append">
                            <button class="btn btn-outline-secondary fa fa-calendar" (click)="end.toggle()"
                                type="button"></button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
        <div class="col-md-3">
            <select id="catalogue_company" (change)="changeInput()" name="catalogue_company" class="form-control col-md-12"
                [(ngModel)]="configId">
                <option *ngFor="let item of listConfig" [value]=item.configId>
                    {{item.title}}</option>
            </select>
        </div>

        <div class="card" style="width: 100%; margin-top: 50px;">
            <h5 class="card-header">Average of catalogue</h5>
            <div class="card-body">
                <div style="width: 100%; height: 500px;">
                    <ngx-charts-line-chart [scheme]="colorLineScheme" [results]="value" [gradient]="gradient"
                        [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend" [showXAxisLabel]="showXAxisLabel"
                        [showYAxisLabel]="showYAxisLabel" [xAxisLabel]="xAxisLabel" [yAxisLabel]="yAxisLabel"
                        [legendTitle]="legendLineTitle">
                    </ngx-charts-line-chart>
                </div>
            </div>
        </div>

        <div class="card" style="width: 48%; margin-top: 10px;">
            <h5 class="card-header">Rank</h5>
            <div class="card-body">
                <div style="width: 100%; height: 400px;">
                    <ngx-charts-pie-chart [results]="data" [scheme]="colorScheme" [animations]="true"
                        [legendTitle]="legendTitle" [legend]="showLegend" [explodeSlices]="explodeSlices"
                        [labels]="showLabels" [doughnut]="doughnut">
                        <ng-template #tooltipTemplate let-model="model">
                            <p style="font-size: 15px; font-weight: bold;">
                                Rank:{{model.name}}
                            </p>
                            <p style="font-size: 15px;">Number of applicant: {{model.value}}</p>
                        </ng-template>
                    </ngx-charts-pie-chart>
                </div>
            </div>
        </div>

        <div class="card" style="width: 50%; margin-left: 2%; margin-top: 10px;">
            <h5 class="card-header">List applicant</h5>
            <div class="card-body">
                <table class="table  table-hover customtable" [svData]="applicantList" #sv="svDataTable"
                    [svRowsOnPage]="10" svSortBy="name" svSortOrder="asc">
                    <thead>
                        <tr class="col-md-12 row no-padding-no-margin">
                            <td class="col-md-1 text-center" style="font-weight: bold">#</td>
                            <td class="col-md-4 text-center" style="font-weight: bold">Fullname</td>
                            <td class="col-md-5 text-center" style="font-weight: bold">Point</td>
                            <td class="col-md-2 text-center" style="font-weight: bold">Action</td>
                        </tr>
                    </thead>
                    <tbody style="height: 300px; overflow: scroll;" *ngIf="sv.data.length != 0;  else searchNull">
                        <tr class="col-md-12 row no-padding-no-margin" *ngFor="let item of sv.data; let i=index">
                            <td class="col-md-1 text-center" style="font-weight: bold">{{i+1}}</td>
                            <td class="col-md-4 text-center" style="font-weight: bold">{{item.fullname}}</td>
                            <td class="col-md-5 text-center" style="font-weight: bold">{{item.point}}</td>
                            <td class="col-md-2 text-center" style="font-weight: bold">
                                <button (click)="sendMail(item);" ngbTooltip="Send mail" class="btn btn-lg btn-danger" data-toggle="button">
                                    <i class="fa fa-envelope" placement="top" 
                                        placement="top"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4">
                                <sv-bootstrap-paginator [rowsOnPageSet]="[5, 25, 50]"></sv-bootstrap-paginator>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>