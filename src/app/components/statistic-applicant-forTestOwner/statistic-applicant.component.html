<ng-template #customLoadingTemplate>
    <div class="custom-class">

    </div>
</ng-template>
<ng-template #searchNull>
    <tr class="col-md-12 row no-padding-no-margin">
        <th class="text-center col-md-12" scope="col">No data</th>
    </tr>
</ng-template>
<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px',fullScreenBackdrop: true  }"
    [template]="customLoadingTemplate">
</ngx-loading>
<div class=" row col-md-12">
    <div class="row col-md-12">
        <div class="col-md-3">
            <b>
                <h2 class="page-header ">
                    Applicant Statistic
                </h2>
            </b>
        </div>

        <div class="col-md-3">
            <select id="catalogue_company" [(ngModel)]="configId" (change)="changeConfig($event.target.value)"
                name="catalogue_company" class="form-control col-md-12">
                <option *ngFor="let item of listConfig" [value]=item.configId>
                    {{item.title}}</option>
            </select>
        </div>

        <div class="col-md-6">
            <div ngbDropdown class="d-inline-block">
                <button class="btn btn-lg btn-outline-primary" id="dropdownForm1" ngbDropdownToggle>
                    <i class="fa fa-filter"></i>
                    Filter By Date</button>
                <div ngbDropdownMenu aria-labelledby="dropdownForm1" style="width: 300px;">
                    <form class="px-4 py-3">
                        <div class="form-group row">
                            <label for="startDate" class="col-md-12">From</label>
                            <div class="input-group col-md-12">
                                <input id="startDate" class="form-control" placeholder="yyyy-mm-dd" name="start"
                                    [(ngModel)]="startDate" [minDate]="minDate" [maxDate]="current" ngbDatepicker
                                    #start="ngbDatepicker">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary fa fa-calendar" (click)="start.toggle()"
                                        type="button"></button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="endDate" class="col-md-12">To</label>
                            <div class="input-group col-md-12">
                                <input id="endDate" class="form-control" placeholder="yyyy-mm-dd" name="end"
                                    [(ngModel)]="endDate" [minDate]="startDate" [maxDate]="current" ngbDatepicker
                                    #end="ngbDatepicker">
                                <div class="input-group-append">
                                    <button class="btn btn-outline-secondary fa fa-calendar" (click)="end.toggle()"
                                        type="button"></button>
                                </div>
                            </div>
                        </div>
                        <button type="submit" (click)="changeDate()" class="btn btn-primary">Search</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="card" style="width: 49%; margin-top: 50px;">
            <h5 class="card-header">Status of all test</h5>
            <div class="card-body" *ngIf="groupReady">
                <div style="width: 100%; height: 400px;">
                    <ngx-charts-bar-vertical-2d [scheme]="colorGroupScheme" [results]="dataGourp" [gradient]="gradient"
                        [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend" [showXAxisLabel]="showXAxisLabel"
                        [showYAxisLabel]="showYAxisLabel"  [yAxisLabel]="yAxisGroupLabel"
                        [legendTitle]="legendGroupTitle" >
                    </ngx-charts-bar-vertical-2d>
                </div>
            </div>
        </div>

        <div class="card" style="width: 50%; margin-left: 1%; margin-top: 50px;">
            <h5 class="card-header">Rank</h5>
            <div class="card-body">
                <div style="width: 100%; height: 400px;">
                    <ngx-charts-pie-chart [results]="valuePieChart" [scheme]="colorScheme" [animations]="true"
                        [legendTitle]="legendTitle" [legend]="showLegend" [explodeSlices]="explodeSlices"
                        [labels]="showLabels" [doughnut]="doughnut">
                        <ng-template #tooltipTemplate let-model="model">
                            <p style="font-size: 15px; font-weight: bold;">
                                Rank:{{model.name}}
                            </p>
                            <p style="font-size: 15px;">Number of applicant: {{model.value}}</p>
                        </ng-template>
                    </ngx-charts-pie-chart>
                </div>
            </div>
        </div>

        <div class="card" style="width: 49%; margin-top: 10px;">
            <h5 class="card-header">Average of catalogue</h5>
            <div class="card-body">
                <div style="width: 100%; height: 500px;">
                    <ngx-charts-line-chart [scheme]="colorLineScheme" [results]="valueLineChart" [gradient]="gradient"
                        [xAxis]="showXAxis" [yAxis]="showYAxis" [legend]="showLegend" [showXAxisLabel]="showXAxisLabel"
                        [showYAxisLabel]="showYAxisLabel" [xAxisLabel]="xAxisLabel" [yAxisLabel]="yAxisLabel"
                        [legendTitle]="legendLineTitle">
                    </ngx-charts-line-chart>
                </div>
            </div>
        </div>



        <div class="card" style="width: 50%; margin-left: 1%; margin-top: 10px;">
            <h5 class="card-header">List applicant</h5>
            <div class="card-body">
                <div class="d-flex justify-content-end">
                    <button (click)="generateExcel();" class="btn btn-lg btn-success "
                     data-toggle="button" placement="top"
                        ngbTooltip="Export to Excel">
                        <i class="fa fa-download"></i>
                    </button>
                </div>
                <table class="table table-hover" [svData]="applicantList" #sv="svDataTable" [svRowsOnPage]="10"
                    svSortBy="name" svSortOrder="asc">
                    <thead>
                        <tr style="background-color: black; color: white" class="col-md-12 row no-padding-no-margin" >
                            <td class="text-center" style="width: 10%; font-weight: bold">#</td>
                            <td class="text-center" style="width: 40%; font-weight: bold">Fullname</td>
                            <td class="text-center" style="width: 20%; font-weight: bold">Point</td>
                            <td class="text-center" style="width: 30%; font-weight: bold">Rank</td>
                        </tr>
                    </thead>
                    <tbody style="height: 300px; overflow: scroll;" *ngIf="sv.data.length != 0;  else searchNull">
                        <tr class="col-md-12 row no-padding-no-margin"  *ngFor="let item of sv.data; let i=index">
                            <td class="text-center" style="width: 10%;font-weight: bold">{{i+1}}</td>
                            <td class="text-center" style="width: 40%; font-weight: bold">{{item.fullName}}</td>
                            <td class="text-center" style="width: 20%; font-weight: bold">{{item.point}}</td>
                            <td class="text-center" style="width: 30%; font-weight: bold">{{item.rank}}</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="4">
                                <sv-bootstrap-paginator [rowsOnPageSet]="[5, 25, 50]"></sv-bootstrap-paginator>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
</div>